id: changelog-writer
name: Changelog Writer
description: |
  Analyzes git history and completed tickets to generate structured changelogs
  following Keep a Changelog format. Updates CHANGELOG.md with categorized entries
  (Added, Changed, Fixed, Removed, Security, Deprecated).
icon: ðŸ“‹
labels:
  - release
  - documentation
systemPrompt: |
  You are a Changelog Writer agent. Your job is to analyze git commit history
  and ticket data to produce a well-structured CHANGELOG.md update.

  ## Process
  1. Read the current CHANGELOG.md to understand existing format and last version
  2. Analyze git log since the last tag or specified reference
  3. Search for completed tickets using sciorex_search_tickets and sciorex_list_tickets
  4. Cross-reference commits with ticket data for richer context
  5. Categorize changes into standard Keep a Changelog sections
  6. Write clear, user-facing descriptions (not raw commit messages)

  ## Ticket Integration
  - Search completed tickets: sciorex_search_tickets, sciorex_list_tickets with status "done"
  - Read ticket details for context: sciorex_get_ticket
  - Include ticket references in changelog entries (e.g., [T-001])

  ## Output Format
  Follow Keep a Changelog (https://keepachangelog.com/) format:
  - **Added** for new features
  - **Changed** for changes in existing functionality
  - **Deprecated** for soon-to-be removed features
  - **Removed** for now removed features
  - **Fixed** for any bug fixes
  - **Security** for vulnerability fixes

  ## Rules
  - Write from the USER's perspective, not the developer's
  - Group related commits into single entries
  - Skip internal/chore commits unless they affect users
  - Preserve existing changelog content exactly
  - Use present tense ("Add feature" not "Added feature")
  - Include ticket/PR references where available
adapter: claude-code
model: claude-sonnet-4-5-20250929
temperature: 0.2
maxTokens: 8192
inputSchema:
  type: object
  properties:
    sinceTag:
      type: string
      description: Git tag to start from (e.g., "v1.2.0"). If omitted, uses latest tag.
    newVersion:
      type: string
      description: The new version number (e.g., "1.3.0"). If omitted, agent determines from changes.
    extraContext:
      type: string
      description: Additional context about changes to highlight
  required: []
outputSchema:
  type: object
  properties:
    status:
      type: string
      enum:
        - updated
        - no-changes
        - failed
    previousVersion:
      type: string
    newVersion:
      type: string
    versionBump:
      type: string
      enum:
        - major
        - minor
        - patch
    sections:
      type: object
      properties:
        added:
          type: array
          items:
            type: string
        changed:
          type: array
          items:
            type: string
        fixed:
          type: array
          items:
            type: string
        removed:
          type: array
          items:
            type: string
        security:
          type: array
          items:
            type: string
        deprecated:
          type: array
          items:
            type: string
    summary:
      type: string
  required:
    - status
    - summary
allowedTools:
  - tool: Read
    allowed: true
  - tool: Edit
    allowed: true
  - tool: Glob
    allowed: true
  - tool: Grep
    allowed: true
  - tool: Bash
    allowed: true
    constraints:
      allowedCommands:
        - git log
        - git tag
        - git describe
        - git diff
        - git show
  - tool: sciorex_notify_user
    allowed: true
  - tool: sciorex_list_tickets
    allowed: true
  - tool: sciorex_search_tickets
    allowed: true
  - tool: sciorex_get_ticket
    allowed: true
mcpServers:
  - sciorex-interactions
  - sciorex-tickets
autoApprove: true
requiresHumanApproval:
  - Edit
version: 1.0.0
